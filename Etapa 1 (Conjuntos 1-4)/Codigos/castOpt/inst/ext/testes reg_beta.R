ma <- matrix(c(0.77828547586148, 0.256386957829818,0.409586540774767,
               0.42947836202055,0.0268073789775372,0.847803192934572,
               0.676644764890922,0.942505211802199,-1.33738430955247,
               0.904624489756099,0.941653636051342,0.40135472863779,
               0.593702298425755,0.241525539197028,0.328935897499032,
               0.873240355668927,0.921185583807528,0.195321000040206,
               0.775095429668853,0.595949422568083,0.0714626101121576,
               0.824119652393782,0.386610290966928,1.6349332608997,
               0.955275102580113,0.697085282299668,0.333007077579299,
               0.858326596356752,0.769589973380789,1.40181262288016,
               0.827803907148719,0.853406241629273,0.451017020860161,
               0.861719541485009,0.844317411771044,0.487323595739937,
               0.814120386935263,0.643304007360712,-0.539737455111534,
               0.876028177318145,0.95618029567413,2.69090741575432,
               0.806010976342034,0.975764479488134,-0.0598160756893157,
               0.815302776622401,0.814303816994652,-0.49747586786043,
               0.858469858551359,0.671889532590285,0.382417149919641,
               0.751760545439223,0.609337196219712,0.409180178437925,
               0.753896983942473,0.312604882521555,0.723745922788961,
               0.624773799757081,0.383381701307371,-0.914924574372468,
               0.640260113350489,0.540824669646099,-0.137185091519559,
               0.841448892752435,0.667495944304392,1.57429327787333,
               0.850197768561358,0.748293482232839,-0.482917703042759,
               0.707506581040036,0.0582965852227062,-0.356190513110566,
               0.515703333124241,0.014243679586798,0.610222274222577,
               0.627610568858073,0.146765201119706,-0.606035147367036,
               0.891974612420479,0.46193340420723,1.13451200339725,
               0.760719455800385,0.59987423568964,0.422468288927292,
               0.782242691377308,0.516561600612476,0.089549711407137,
               0.609458109949379,0.45191124943085,-1.59171399396362,
               0.421196263293514,0.40570753836073,-0.347167014243029,
               0.738006121993186,0.749599400907755,2.03429598442535,
               0.80289758904481,0.520484071224928,-0.28590515559225,
               0.858714714995141,0.610321870073676,0.654378782982205,
               0.465231744382179,0.0231961566023529,-0.924747616969478,
               0.190233285069689,0.0980172585695982,-1.59070303925404,
               0.84596120649134,0.635417424840853,0.709398469649404,
               0.772810913256628,0.259563202736899,1.44932679629708,
               0.529411907975524,0.50120853446424,-1.54438030938404,
               0.69362500521142,0.295341062126681,0.846069248221398,
               0.649508557836339,0.311208226718009,0.330932470678367,
               0.438425271632952,0.253405889263377,-0.366187310859143,
               0.733643275639297,0.0020888748113066,1.74928498341616,
               0.631052190326857,0.293670512503013,-1.005144961456,
               0.651510755782373,0.340458276914433,-0.117439298841842,
               0.678217799165823,0.121395356487483,0.668505546538097,
               0.588019409645503,0.547048786189407,-1.08247402143283,
               0.509352087008203,0.363105745054781,1.10596780578619,
               0.595647364389419,0.471634902292863,-0.114153381934486,
               0.513098894355905,0.0597823809366673,1.2291483044291,
               0.322188550922647,0.27136250352487,-0.0232968160916682,
               0.906673480526936,0.987368808826432,-0.735105466620172,
               0.689737549766178,0.62613928783685,-1.34051483313352,
               0.351325545356566,0.203850432764739,-1.37306589237184,
               0.618029522541552,0.18128219852224,-0.149057093973935,
               0.695229262736661,0.99722205218859,-2.00627595919716,
               0.544627928549451,0.757811795920134,-1.55956853741809,
               0.950109597882973,0.442770944209769,1.96270156915108,
               0.830007913475288,0.795522037195042,-0.178318223605633,
               0.897606140539366,0.603163188090548,1.35762067316143,
               0.930412385564797,0.830853478051722,1.64899204713817,
               0.628374086343059,0.00403298391029239,0.119484570593628,
               0.669074898722052,0.787810224108398,0.00362061633761048,
               0.52237096295394,0.021086941473186,0.19644344592465,
               0.882310736268115,0.362371430499479,0.679739506730702,
               0.552090798289635,0.222682373365387,0.801124844964395,
               0.424795823487681,0.490048686275259,-2.01520057977609,
               0.57868613222501,0.466551078017801,0.0473959880866878,
               0.802100504461647,0.893447614973411,0.613096606859849,
               0.494278651769093,0.219506683060899,-0.170018481053399,
               0.70327833948785,0.72938100178726,0.225759524431785,
               0.77615949954093,0.270932437386364,0.892404141125057,
               0.759062724750569,0.635660407599062,-0.147613098756459,
               0.832370089987243,0.0629581185057759,1.53718231037047,
               0.666040231877398,0.899583113379776,0.452619354870756,
               0.380117932840957,0.25025016721338,-1.59569425257054,
               0.476394432358487,0.265380147378892,-0.187165292033729,
               0.683793718131691,0.172535816440359,0.567634468128946,
               0.591902697270659,0.510077520506456,0.162679116763597,
               0.305302182477227,0.194665657822043,-1.37198301292582,
               0.634007949036001,0.90345785417594,-1.88395251169133,
               0.820812390817673,0.976796131813899,-0.0680470081647294,
               0.703102248130062,0.401374991517514,0.687306933852914,
               0.80876263699827,0.886078621027991,-0.708000728772153,
               0.825749873855162,0.55369341163896,0.377677268816157,
               0.731946419236464,0.296525959158316,0.580757739274482,
               0.595809037580248,0.441694973036647,0.974626092393341,
               0.914327320424122,0.941671287408099,0.587452509331047,
               0.819728213433139,0.891385620692745,0.245278778823427,
               0.283153211488622,0.14769275044091,-1.5660037041717,
               0.743371644479951,0.553862455766648,-0.508128148093857,
               0.956424898037014,0.844479234190658,0.85827885392439,
               0.940501568049335,0.526804794091731,0.451866719214799,
               0.569316081589189,0.752765083452687,-0.897904236853133,
               0.593662220481263,0.247865482000634,0.31901114488487,
               0.827558563057377,0.62705985433422,-0.0939645105797747,
               0.626575472251894,0.337804336333647,1.26430832492208,
               0.976352067676505,0.813543838681653,-0.0340093652786424,
               0.669040733616395,0.0582990173716098,-0.388169030127935,
               0.515278574484461,0.636065219296142,-0.260454831909338), byrow = TRUE, nrow=100, ncol=3 )


df <- data.frame(test_matrix)

data(df, package = "betareg")


#resultado do pacote betareg
library(betareg)
reg <- betareg(X1 ~ X2+X3, data = df)
summary(reg)

#OBS: DADOS GERADOS COM OS PARAMETROS (0.1 ; 1.5 ; 0.5; 15) com LOGL = 87,9

#avalia a loglikelihood usando pacote castopt
library(castOpt)
sum = 0
reg_beta(sum = sum, x = c(-0.03102, 1.75773, 0.47257, 16.457), N =4, data = test_matrix)
sum


#DADOS 2 - PARAM (0.5 ; 2 ; 0.8 ; 30) com LOGL = 140.1


goTestMax <- function(par, test_matrix, fnName=c("reg_beta")){
  fnName <- match.arg(fnName)
  sum = 0
  do.call(fnName, list(sum = sum, x=as.double(par), N=length(par), data = test_matrix))
  -1*sum
}




